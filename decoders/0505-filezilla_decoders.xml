<!--
  -  Filezilla decoders
  -  Created by Wazuh, Inc.
  -  Copyright (C) 2015-2020, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->


<!-- 
  - Pre match for filezilla server for windows
  - Examples:
  - (000005)3/13/2019 1:30:01 AM -
  -->
<decoder name="filezilla">
  <prematch>^\(\d+\) \S+ \S+ \w+ - </prematch>
</decoder>

<!-- 
  - Extract ip, id (number) and action
  - Examples:
  - (000010) 3/13/2019 5:09:45 AM - (not logged in) (10.0.0.1)> 530 Login or password incorrect!
  -->
<decoder name="filezilla-not-logged">
  <parent>filezilla</parent>
  <prematch offset="after_parent">\(not logged in\) \(\S+\)> \.+ </prematch>
  <regex offset="after_parent">\(not logged in\) \((\S+)\)> (\S+) (\.+)</regex>
  <order>srcip, id, action</order>
</decoder>

<!-- 
  - 
  - Extract user, ip, id and action
  - Examples:
  - (000004) 3/13/2019 1:29:52 AM - usuario (10.0.0.1)> 550 Permission denied
  -->
<decoder name="filezilla-user-action">
  <parent>filezilla</parent>
  <prematch offset="after_parent">\S+ \(\S+\)> \S+ \.</prematch>
  <regex offset="after_parent">(\S+) \((\S+)\)> (\S+) (\.+)</regex>
  <order>srcuser, srcip, id, acction</order>
</decoder>

<!-- 
  - 
  - Extract user, ip and id
  - Examples:
  - (000004) 3/13/2019 1:29:52 AM - usuario (10.0.0.1)> 550 Permission denied
  -->
<decoder name="filezilla-user-command">
  <parent>filezilla</parent>
  <prematch offset="after_parent">\S+ \(\S+\)> \S+</prematch>
  <regex offset="after_parent">(\S+) \((\S+)\)> (\S+)</regex>
  <order>srcuser, srcip, id</order>
</decoder>
