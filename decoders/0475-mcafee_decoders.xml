<!--
  -  McAfee EPO decoder
  -  Updated by Wazuh, Inc.
  -  Copyright (C) 2015-2019, Wazuh Inc.
  -  Copyright (C) 2009 Trend Micro Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->
<decoder name="mcafee-epo2">
        <prematch>\pEPOEvent\p</prematch>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pMachineName\p(\.+)\p/MachineName\p</regex>
    <order>machine_name</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAgentGUID\p(\.+)\p/AgentGUID\p</regex>
    <order>agent_guid</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pIPAddress\p(\.+)\p/IPAddress\p</regex>
    <order>ip.address</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pOSName\p(\.+)\p/OSName\p</regex>
    <order>os.name</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pUserName\p(\.+)\p/UserName\p</regex>
    <order>username</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTimeZoneBias\p(\.+)\p/TimeZoneBias\p</regex>
    <order>timezone_bias</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pRawMACAddress\p(\.+)\p/RawMACAddress\p</regex>
    <order>mac_address</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent"> ProductName=\p(\.+)\p ProductVersion=\p(\.+)\p ProductFamily=\p(\.+)\p</regex>
    <order>product_name,product_version,product_family</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzer\p(\.+)\p/Analyzer\p</regex>
    <order>Analyzer</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzerName\p(\.+)\p/AnalyzerName\p</regex>
    <order>AnalyzerName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzerVersion\p(\.+)\p/AnalyzerVersion\p</regex>
    <order>AnalyzerVersion</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzerHostName\p(\.+)\p/AnalyzerHostName\p</regex>
    <order>AnalyzerHostName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzerDetectionMethod\p(\.+)\p/AnalyzerDetectionMethod\p</regex>
    <order>AnalyzerDetectionMethod</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pEventID\p(\.+)\p/EventID\p</regex>
    <order>EventID</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSeverity\p(\.+)\p/Severity\p</regex>
    <order>Severity</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pGMTTime\p(\.+)\p/GMTTime\p</regex>
    <order>GMTTime</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pThreatCategory\p(\.+)\p/ThreatCategory\p</regex>
    <order>ThreatCategory</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pThreatEventID\p(\.+)\p/ThreatEventID\p</regex>
    <order>ThreatEventID</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pThreatName\p(\.+)\p/ThreatName\p</regex>
    <order>ThreatName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pThreatType\p(\.+)\p/ThreatType\p</regex>
    <order>ThreatType</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pDetectedUTC\p(\.+)\p/DetectedUTC\p</regex>
    <order>DetectedUTC</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pThreatActionTaken\p(\.+)\p/ThreatActionTaken\p</regex>
    <order>ThreatActionTaken</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pThreatHandled\p(\.+)\p/ThreatHandled\p</regex>
    <order>ThreatHandled</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceUserName\p(\.+)\p/SourceUserName\p</regex>
    <order>SourceUserName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceProcessName\p(\.+)\p/SourceProcessName\p</regex>
    <order>SourceProcessName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTargetHostName\p(\.+)\p/TargetHostName\p</regex>
    <order>TargetHostName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTargetUserName\p(\.+)\p/TargetUserName\p</regex>
    <order>TargetUserName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTargetFileName\p(\.+)\p/TargetFileName\p</regex>
    <order>TargetFileName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pThreatSeverity\p(\.+)\p/ThreatSeverity\p</regex>
    <order>ThreatSeverity</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pBladeName\p(\.+)\p/BladeName\p</regex>
    <order>BladeName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzerContentVersion\p(\.+)\p/AnalyzerContentVersion\p</regex>
    <order>AnalyzerContentVersion</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzerContentCreationDate\p(\.+)\p/AnalyzerContentCreationDate\p</regex>
    <order>AnalyzerContentCreationDate</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAnalyzerRuleName\p(\.+)\p/AnalyzerRuleName\p</regex>
    <order>AnalyzerRuleName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceProcessHash\p(\.+)\p/SourceProcessHash\p</regex>
    <order>SourceProcessHash</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceProcessSigned\p(\.+)\p/SourceProcessSigned\p</regex>
    <order>SourceProcessSigned</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceProcessSigner\p(\.+)\p/SourceProcessSigner\p</regex>
    <order>SourceProcessSigner</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceProcessTrusted\p(\.+)\p/SourceProcessTrusted\p</regex>
    <order>SourceProcessTrusted</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceFilePath\p(\.+)\p/SourceFilePath\p</regex>
    <order>SourceFilePath</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceFileSize\p(\.+)\p/SourceFileSize\p</regex>
    <order>SourceFileSize</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceModifyTime\p(\.+)\p/SourceModifyTime\p</regex>
    <order>SourceModifyTime</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceAccessTime\p(\.+)\p/SourceAccessTime\p</regex>
    <order>SourceAccessTime</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pSourceCreateTime\p(\.+)\p/SourceCreateTime\p</regex>
    <order>SourceCreateTime</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTargetName\p(\.+)\p/TargetName\p</regex>
    <order>TargetName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTargetPath\p(\.+)\p/TargetPath\p</regex>
    <order>TargetPath</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTargetSigned\p(\.+)\p/TargetSigned\p</regex>
    <order>TargetSigned</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTargetTrusted\p(\.+)\p/TargetTrusted\p</regex>
    <order>TargetTrusted</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAttackVectorType\p(\.+)\p/AttackVectorType\p</regex>
    <order>AttackVectorType</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pDurationBeforeDetection\p(\.+)\p/DurationBeforeDetection\p</regex>
    <order>DurationBeforeDetection</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pNaturalLangDescription\p(\.+)\p/NaturalLangDescription\p</regex>
    <order>NaturalLangDescription</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pAccessRequested\p(\.+)\p/AccessRequested\p</regex>
    <order>AccessRequested</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pPolicyName\p(\.+)\p/PolicyName\p</regex>
    <order>PolicyName</order>
</decoder>

<decoder name="mcafee-epo2-fields">
    <parent>mcafee-epo2</parent>
    <regex offset="after_parent">\pTimeSZone\p(\.+)\p/TimeSZone\p</regex>
    <order>Timezone</order>
</decoder>
