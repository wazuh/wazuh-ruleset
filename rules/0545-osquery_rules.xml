<!--
  -  Osquery ruleset
  -  Created by Wazuh, Inc.
  -  Copyright (C) 2015-2019, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<group name="osquery,">

  <rule id="24000" level="3">
    <location>osquery$</location>
    <description>osquery message</description>
  </rule>

  <rule id="24001" level="5">
    <if_sid>24000</if_sid>
    <regex>^E\d\d\d\d </regex>
    <description>osquery error message</description>
  </rule>

  <rule id="24002" level="3">
    <if_sid>24000</if_sid>
    <regex>^W\d\d\d\d </regex>
    <description>osquery warning message</description>
  </rule>

  <rule id="24003" level="2">
    <if_sid>24000</if_sid>
    <regex>^I\d\d\d\d </regex>
    <description>osquery information message</description>
  </rule>

  <rule id="24010" level="3">
    <if_sid>24000</if_sid>
    <decoded_as>json</decoded_as>
    <description>osquery: $(osquery.name) query result</description>
  </rule>

  <rule id="24011" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">high_load_average</field>
    <description>osquery: System memory is under $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24012" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">low_free_memory</field>
    <description>osquery: System memory is under $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24013" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">low_disk_space</field>
    <description>osquery: Free disk space is under $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24014" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">disk_time_busy</field>
    <description>osquery: Disk busy time is over $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24020" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^osquery-monitoring$</field>
    <description>osquery: $(osquery.pack) query result</description>
    <group>osquery_monitoring,</group>
  </rule>

  <rule id="24021" level="4">
    <if_sid>24020</if_sid>
    <field name="osquery.name">schedule</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): The pack executed is $(osquery.columns.name) and the interval is $(osquery.columns.interval) </description>
    <group>osquery_monitoring,</group>
  </rule>

  <rule id="24022" level="4">
    <if_sid>24020</if_sid>
    <field name="osquery.name">events</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): The event executed is $(osquery.columns.name) and the publisher is $(osquery.columns.publisher) </description>
    <group>osquery_monitoring,</group>
  </rule>

  <rule id="24023" level="4">
    <if_sid>24020</if_sid>
    <field name="osquery.name">osquery_info</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Osquery version is $(osquery.columns.version) build on $(osquery.columns.build_platform) $(osquery.columns.build_distro)</description>
    <group>osquery_monitoring,</group>
  </rule>

  <rule id="24030" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^incident-response$</field>
    <description>osquery: $(osquery.pack) query result</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24031" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">launchd</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Running daemon is $(osquery.columns.label) with path $(osquery.columns.program) and username $(osquery.columns.username)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24032" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">startup_items</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Program $(osquery.columns.name) is launched at system startup</description>
    <group>incident_response,</group>
  </rule>

    <rule id="24033" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">crontab</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Command launched $(osquery.columns.command) at $(osquery.columns.hour):$(osquery.columns.minute) $(osquery.columns.day_of_month) $(osquery.columns.month) </description>
    <group>incident_response,</group>
  </rule>

  <rule id="24034" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">loginwindow1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Key $(osquery.columns.key), Value $(osquery.columns.value)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24035" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">loginwindow2</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Key $(osquery.columns.key), Value $(osquery.columns.value)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24036" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">loginwindow3</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Username $(osquery.columns.username), Key $(osquery.columns.key)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24037" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">loginwindow4</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Username $(osquery.columns.username), Key $(osquery.columns.key)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24038" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">alf</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX version $(osquery.columns.version)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24039" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">alf</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX version $(osquery.columns.version)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24040" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">alf_exceptions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX service exceptions path $(osquery.columns.path)</description>
    <group>incident_response,</group>
  </rule>

    <rule id="24041" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">alf_services</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX service $(osquery.columns.service) state $(osquery.columns.state)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24042" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">alf_explicit_auths</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Process $(osquery.columns.process) has explicit authorization for Application Layer Firewall OSX</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24043" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">etc_hosts</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Address $(osquery.columns.address) Hostnames $(osquery.columns.hostnames)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24044" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">kextstat</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Kernel module $(osquery.columns.name) version $(osquery.columns.version)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24045" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">kernel_modules</field>
    <field name="osquery.columns.status">Live</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS Kernel module $(osquery.columns.name) is enabled and used by $(osquery.columns.used_by)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24046" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">last</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): User $(osquery.columns.username) host $(osquery.columns.host)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24047" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">installed_applications</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS X Application $(osquery.columns.name) version $(osquery.columns.bundle_version) is installed</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24048" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">open_sockets</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Process $(osquery.columns.pid) has local port $(osquery.columns.local_port) opened</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24049" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">open_files</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Process $(osquery.columns.pid) has file $(osquery.columns.path) opened</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24050" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">logged_in_users</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): User $(osquery.columns.user) is logged from host $(osquery.columns.host) </description>
    <group>incident_response,</group>
  </rule>

  <rule id="24051" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">ip_forwarding</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Status of IP/IPv6 forwarding $(osquery.columns.name) value $(osquery.columns.current_value)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24052" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">process_env</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Process $(osquery.columns.pid) Environment variable $(osquery.columns.key) value $(osquery.columns.value)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24053" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">mounts</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Mount point at $(osquery.columns.device) with $(osquery.columns.blocks_free) free blocks</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24054" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">nfs_shares</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Shared NFS $(osquery.columns.share) options $(osquery.columns.options) </description>
    <group>incident_response,</group>
  </rule>

  <rule id="24055" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">shell_history</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): User $(osquery.columns.username) history file $(osquery.columns.history_file) executed command $(osquery.columns.command)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24056" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">recent_items</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): User $(osquery.columns.username) opened recent item $(osquery.columns.value)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24057" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">ramdisk</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Virtual interface $(osquery.columns.name) with uuid $(osquery.columns.uuid) is on the system</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24058" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">listening_ports</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Process $(osquery.columns.pid) has opened port $(osquery.columns.port) address $(osquery.columns.address) </description>
    <group>incident_response,</group>
  </rule>

  <rule id="24059" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">suid_bin</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): File $(osquery.columns.path) has setuid enabled</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24060" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">process_memory</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Process $(osquery.columns.pid) $(osquery.columns.path) memory start $(osquery.columns.start), memory end $(osquery.columns.end)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24061" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">arp_cache</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): ARP cache: Address $(osquery.columns.address) MAC $(osquery.columns.mac) Interface $(osquery.columns.interface)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24062" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">wireless_networks</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Wireless network $(osquery.columns.network_name) is on remembered list</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24063" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">disk_encryption</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Device $(osquery.columns.name) encryption status is $(osquery.columns.encryption_status)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24064" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">iptables</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Iptable source ip $(osquery.columns.src_ip) with policy $(osquery.columns.policy) and target $(osquery.columns.target) has a packet count of $(osquery.columns.packets)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24065" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">app_schemes</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): App scheme $(osquery.columns.scheme) handler is $(osquery.columns.handler)</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24066" level="4">
    <if_sid>24030</if_sid>
    <field name="osquery.name">sandboxes</field>
    <field name="osquery.columns.enabled">1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Sandbox $(osquery.columns.label) with user $(osquery.columns.user) is enabled</description>
    <group>incident_response,</group>
  </rule>

  <rule id="24100" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^it-compliance$</field>
    <description>osquery: $(osquery.pack) query result</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24101" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">osquery_info</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Osquery version is $(osquery.columns.version) build on $(osquery.columns.build_platform) $(osquery.columns.build_distro)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24102" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">ad_config</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Active Directory name $(osquery.columns.name) with domain $(osquery.columns.domain) has a value of $(osquery.columns.value)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24103" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">kernel_info</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS kernel version $(osquery.columns.version), path $(osquery.columns.path)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24104" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">os_version</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS $(osquery.columns.name) $(osquery.columns.version) $(osquery.columns.major).$(osquery.columns.minor) $(osquery.columns.codename)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24105" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">alf</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX version $(osquery.columns.version)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24106" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">alf</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX version $(osquery.columns.version)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24107" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">alf_exceptions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX service exceptions path $(osquery.columns.path)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24108" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">alf_services</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Application Layer Firewall for OSX service $(osquery.columns.service) state $(osquery.columns.state)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24109" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">alf_explicit_auths</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Process $(osquery.columns.process) has explicit authorization for Application Layer Firewall OSX</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24110" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">mounts</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Mount point $(osquery.columns.path) at with $(osquery.columns.blocks_free) free blocks</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24111" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">nfs_shares</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Shared NFS $(osquery.columns.share) options $(osquery.columns.options)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24112" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">windows_shared_resources</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Windows shared resource $(osquery.columns.name) with path $(osquery.columns.path) status is $(osquery.columns.status)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24113" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">browser_plugins</field>
    <field name="osquery.columns.disabled">0</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Browser plugin $(osquery.columns.name) is enabled</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24114" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">browser_plugins</field>
    <field name="osquery.columns.disabled">1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Browser plugin $(osquery.columns.name) is disabled</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24115" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">safari_extensions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Safari extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24116" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">chrome_extensions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Chrome extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24117" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">firefox_addons</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Firefox addon $(osquery.columns.name) type is $(osquery.columns.type) and the user that owns it is $(osquery.columns.uid)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24118" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">homebrew_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Homebrew package $(osquery.columns.name) version is $(osquery.columns.version)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24119" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">windows_programs</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Windows program $(osquery.columns.name) $(osquery.columns.version) is installed on the system</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24120" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">windows_patches</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Windows patch $(osquery.columns.hotfix_id) is installed on the system</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24121" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">package_receipts</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OSX package recepit $(osquery.columns.package_id) $(osquery.columns.version) is installed on the system</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24122" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">usb_devices</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): USB device from vendor $(osquery.columns.vendor) is attached to port $(osquery.columns.usb_port)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24123" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">keychain_items</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Keychain $(osquery.columns.label) path is $(osquery.columns.path)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24124" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">keychain_items</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Keychain $(osquery.columns.label) path is $(osquery.columns.path)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24125" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">deb_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Package name $(osquery.columns.name), version $(osquery.columns.version), revision $(osquery.columns.revision),size $(osquery.columns.size) bytes</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24126" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">apt_sources</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Repository name $(osquery.columns.name), version $(osquery.columns.version), source $(osquery.columns.source),release name $(osquery.columns.release)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24127" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">portage_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Portage package $(osquery.columns.package) $(osquery.columns.version) USE flags $(osquery.columns.flags)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24128" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">portage_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Portage package $(osquery.columns.package) $(osquery.columns.version) USE flags $(osquery.columns.flags)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24129" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">kernel_modules</field>
    <field name="osquery.columns.status">Live</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS Kernel module $(osquery.columns.name) is enabled and used by $(osquery.columns.used_by)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24130" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">windows_drivers</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Windows device $(osquery.columns.device_name) driver is being used</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24131" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">rpm_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): RPM package $(osquery.columns.name) version $(osquery.columns.version) is installed on the system</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24132" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">rpm_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): RPM package $(osquery.columns.name) version $(osquery.columns.version) is installed on the system</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24133" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">installed_applications</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS X Application $(osquery.columns.name) version $(osquery.columns.bundle_version) is installed</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24134" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">disk_encryption</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Device $(osquery.columns.name) encryption status is $(osquery.columns.encryption_status)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24135" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">launchd</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Running daemon is $(osquery.columns.label) with path $(osquery.columns.program) and username $(osquery.columns.username)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24136" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">iptables</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Iptable source ip $(osquery.columns.src_ip) with policy $(osquery.columns.policy) and target $(osquery.columns.target) has a packet count of $(osquery.columns.packets)</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24137" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">sip_config</field>
    <field name="osquery.columns.enabled">1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Integrity protection flag $(osquery.columns.config_flag) is enabled</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24138" level="4">
    <if_sid>24100</if_sid>
    <field name="osquery.name">sip_config</field>
    <field name="osquery.columns.enabled">0</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Integrity protection flag $(osquery.columns.config_flag) is disabled</description>
    <group>it_compliance,</group>
  </rule>

  <rule id="24200" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^osx-attacks$</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): $(osquery.columns.name) malware process detected</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24201" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">Leverage-A_2</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Leverage-A_2 malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24202" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">iWorkServ</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OSX iWorkServ malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24203" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">iWorm_1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): iWorm_1 malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24204" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">HackingTeam_Mac_RAT1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): HackingTeam Mac RAT1 malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24205" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">HackingTeam_Mac_RAT2</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): HackingTeam Mac RAT2 malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24206" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">HackingTeam_Mac_Persistence</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): HackingTeam Mac Persistence malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24207" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">Keranger_2</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Keranger malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24208" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_Backdoor_Mokes</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OSX Backdoor Mokes malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24209" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_Komplex</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Komplex malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24210" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OceanLotus_dropped_file_1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OceanLotus malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24211" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_DOK_2</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OSX/Dok malware detected in certificate $(osquery.columns.common_name)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24212" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_DOK_3</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OSX/Dok malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24213" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_Snake</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Snake malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24214" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_Proton_Files</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Proton malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24215" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_MaMi_DNS_Servers</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): MaMi malware detected, infected DNS address $(osquery.columns.address)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24216" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_MaMi_Certificate</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): MaMi malware detected in certificate $(osquery.columns.common_name)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24217" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_ColdRoot_RAT_Files</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Coldroot RAT malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24218" level="4">
    <if_sid>24200</if_sid>
    <field name="osquery.name">OSX_Dummy_Files</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OSX Dummy malware detected on path $(osquery.columns.path)</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24300" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^vuln-management$</field>
    <description>osquery: $(osquery.pack) query result</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24301" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">kernel_info</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Kernel version is $(osquery.columns.version) with path $(osquery.columns.path) and kernel device identifier $(osquery.columns.device) </description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24302" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">os_version</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS $(osquery.columns.name) $(osquery.columns.version) with minor $(osquery.columns.minor) and major $(osquery.columns.major)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24303" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">kextstat</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Kernel module $(osquery.columns.name) version $(osquery.columns.version)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24304" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">kernel_modules</field>
    <field name="osquery.columns.status">Live</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS Kernel module $(osquery.columns.name) is enabled and used by $(osquery.columns.used_by)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24305" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">installed_applications</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS X Application $(osquery.columns.name) version $(osquery.columns.bundle_version) is installed</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24306" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">browser_plugins</field>
    <field name="osquery.columns.disabled">0</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Browser plugin $(osquery.columns.name) is enabled</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24307" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">browser_plugins</field>
    <field name="osquery.columns.disabled">1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Browser plugin $(osquery.columns.name) is disabled</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24308" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">safari_extensions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Safari extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24309" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">opera_extensions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Opera extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24310" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">chrome_extensions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Chrome extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24311" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">firefox_addons</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Firefox addon $(osquery.columns.name) type is $(osquery.columns.type) and the user that owns it is $(osquery.columns.uid)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24312" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">homebrew_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Homebrew package $(osquery.columns.name) version is $(osquery.columns.version)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24313" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">package_receipts</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OSX package recepit $(osquery.columns.package_id) $(osquery.columns.version) is installed on the system</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24314" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">deb_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Package name $(osquery.columns.name), version $(osquery.columns.version), revision $(osquery.columns.revision),size $(osquery.columns.size) bytes</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24315" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">apt_sources</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Repository name $(osquery.columns.name), version $(osquery.columns.version), source $(osquery.columns.source),release name $(osquery.columns.release)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24316" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">portage_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Portage package $(osquery.columns.package) $(osquery.columns.version) USE flags $(osquery.columns.flags)</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24317" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">rpm_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): RPM package $(osquery.columns.name) version $(osquery.columns.version) is installed on the system</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24318" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">unauthenticated_sparkle_feeds</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Sparkle bundle $(osquery.columns.name) is unauthenticated</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24319" level="4">
    <if_sid>24300</if_sid>
    <field name="osquery.name">backdoored_python_packages</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Python package $(osquery.columns.package_name) is backdoored</description>
    <group>vuln_management,</group>
  </rule>

  <rule id="24400" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^hardware-monitoring$</field>
    <description>osquery: $(osquery.pack) query result</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24401" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">acpi_tables</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): ACPI table $(osquery.columns.name) size is $(osquery.columns.size)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24402" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">cpuid</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): CPU feature $(osquery.columns.feature) and value $(osquery.columns.value)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24403" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">smbios_tables</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): ACPI table $(osquery.columns.name) size is $(osquery.columns.size)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24404" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">nvram</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): NVRAM variable $(osquery.columns.name) value $(osquery.columns.value)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24405" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">pci_devices</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): PCI device $(osquery.columns.model) with vendor $(osquery.columns.vendor) is active</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24406" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">fan_speeds</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Fan $(osquery.columns.name) actual speed is $(osquery.columns.actual) rpm</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24407" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">temperatures</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Temperature sensor $(osquery.columns.name) is at $(osquery.columns.celsius) celsius</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24408" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">usb_devices</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): USB device from vendor $(osquery.columns.vendor) is attached to port $(osquery.columns.usb_port)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24409" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">hardware_events</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Hardware device $(osquery.columns.model) triggered action $(osquery.columns.action)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24410" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">darwin_kernel_system_controls</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): System control $(osquery.columns.name) oid is $(osquery.columns.oid)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24411" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">iokit_devicetree</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): IOKit device $(osquery.columns.name) busy state is $(osquery.columns.busy_state)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24412" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">efi_file_hashes</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): EFI file $(osquery.columns.path) sha256 $(osquery.columns.sha256)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24413" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">kernel_extensions</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS X Kernel extension $(osquery.columns.name) with version $(osquery.columns.version) is loaded</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24414" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">kernel_modules</field>
    <field name="osquery.columns.status">Live</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): OS Kernel module $(osquery.columns.name) is enabled and used by $(osquery.columns.used_by)</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24415" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">windows_drivers</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Windows device $(osquery.columns.device_name) driver is being used</description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24416" level="4">
    <if_sid>24400</if_sid>
    <field name="osquery.name">device_nodes</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Device $(osquery.columns.path), UID $(osquery.columns.uid), GID $(osquery.columns.gid), type $(osquery.columns.type) </description>
    <group>hardware_monitoring,</group>
  </rule>

  <rule id="24500" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^ossec-rootkit$</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Ossec rootkit file $(osquery.columns.path) detected</description>
    <group>ossec_rootkit,</group>
  </rule>

  <rule id="24600" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^windows-hardening$</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Windows Registry key $(osquery.columns.key) value is $(osquery.columns.data)</description>
    <group>windows_hardening,</group>
  </rule>

  <rule id="24700" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^windows-attacks$</field>
    <description>osquery: $(osquery.pack) query result</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24701" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">CCleaner_Trojan.Floxif</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): CCleaner Trojan Floxif detected on registry path $(osquery.columns.path)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24702" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">CCleaner_Trojan_stage2.Floxif</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): CCleaner Trojan Floxif detected on service $(osquery.columns.name) for user $(osquery.columns.user_account)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24703" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">Winsecurity_info_1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Winsecurity.info Scam detected on path $(osquery.columns.install_location)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24704" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">Winsecurity_info_2</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Winsecurity.info Scam detected on Chrome extension $(osquery.columns.name)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24705" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">unTabs_1</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): unTabs Browser extension malware detected on path $(osquery.columns.install_location)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24706" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">unTabs_2</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): unTabs Chrome extension malware detected $(osquery.columns.name)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24707" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">StickyKeys_File_Replace_Backdoor</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Sticky file key backdoor detected for program $(osquery.columns.path)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24708" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">StickyKeys_Registry_Backdoor</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Sticky registry key backdoor detected for key $(osquery.columns.path)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24709" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">conhost.exe_incorrect_path</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): conhost.exe process masquerading detected, path is $(osquery.columns.path)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24710" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">dllhost.exe_incorrect_path</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): dllhost.exe process masquerading detected, path is $(osquery.columns.path)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24711" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">lsass.exe_incorrect_path</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): lsass.exe process masquerading detected, path is $(osquery.columns.path)</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24712" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">services.exe_incorrect_parent_process</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): services.exe process masquerading detected, the parent process is incorrect</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24713" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">svchost.exe_incorrect_path</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): svchost.exe process masquerading detected, path $(osquery.columns.path) is incorrect</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24714" level="4">
    <if_sid>24700</if_sid>
    <field name="osquery.name">svchost.exe_incorrect_parent_process</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): svchost.exe process masquerading detected, the parent process is incorrect</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24800" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^unwanted-chrome-extensions$</field>
    <description>osquery: $(osquery.pack) query result</description>
  </rule>

  <rule id="24801" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">BetternetVPN</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): BetternetVPN Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24802" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">Chrometana</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Chrometana Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24803" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">CopyFish</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): CopyFish Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24804" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">Giphy</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): Giphy Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24805" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">HolaVPN</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): HolaVPN Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24806" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">InfinityNewTab</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): InfinityNewTab Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24807" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">SocialFixer</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): SocialFixer Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24808" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">TouchVPN</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): TouchVPN Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24809" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">WebDeveloper</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): WebDeveloper Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24810" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">WebPaint</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): WebPaint Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

  <rule id="24811" level="4">
    <if_sid>24800</if_sid>
    <field name="osquery.name">MacOSInstallCore</field>
    <description>osquery: $(osquery.pack) $(osquery.subquery): MacOSInstallCore Chrome extension malware detected</description>
    <group>unwanted_chrome,</group>
  </rule>

</group>
