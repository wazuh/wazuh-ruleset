<group name="osquery,">

  <rule id="24000" level="3">
    <location>osquery$</location>
    <description>osquery message</description>
  </rule>

  <rule id="24001" level="5">
    <if_sid>24000</if_sid>
    <regex>^E\d\d\d\d </regex>
    <description>osquery error message</description>
  </rule>

  <rule id="24002" level="3">
    <if_sid>24000</if_sid>
    <regex>^W\d\d\d\d </regex>
    <description>osquery warning message</description>
  </rule>

  <rule id="24003" level="2">
    <if_sid>24000</if_sid>
    <regex>^I\d\d\d\d </regex>
    <description>osquery information message</description>
  </rule>

  <rule id="24010" level="3">
    <if_sid>24000</if_sid>
    <decoded_as>json</decoded_as>
    <description>osquery: $(osquery.name) query result</description>
  </rule>

  <rule id="24011" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">high_load_average</field>
    <description>System memory is under $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24012" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">low_free_memory</field>
    <description>System memory is under $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24013" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">low_disk_space</field>
    <description>Free disk space is under $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24014" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.name">disk_time_busy</field>
    <description>Disk busy time is over $(osquery.columns.threshold)</description>
  </rule>

  <rule id="24020" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^osquery-monitoring$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>osquery_monitoring,</group>
  </rule>

            <rule id="24021" level="4">
              <if_sid>24020</if_sid>
              <field name="osquery.name">schedule</field>
              <description>osquery: $(osquery.name): The pack executed is $(osquery.columns.name) and the interval is $(osquery.columns.interval) </description>
              <group>osquery_monitoring,</group>
            </rule>

            <rule id="24022" level="4">
              <if_sid>24020</if_sid>
              <field name="osquery.name">events</field>
              <description>osquery: $(osquery.name): The event executed is $(osquery.columns.name) and the publisher is $(osquery.columns.publisher) </description>
              <group>osquery_monitoring,</group>
            </rule>

            <rule id="24023" level="4">
              <if_sid>24020</if_sid>
              <field name="osquery.name">osquery_info</field>
              <description>osquery: $(osquery.name): Osquery version is $(osquery.columns.version) running on $(osquery.columns.build_platform) $(osquery.columns.build_distro)</description>
              <group>osquery_monitoring,</group>
            </rule>

  <rule id="24030" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^incident-response$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>incident_response,</group>
  </rule>

          <rule id="24031" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">listening_ports</field>
            <description>osquery: $(osquery.name): Process with PID $(osquery.columns.pid) and path $(osquery.columns.path)  is listening on port $(osquery.columns.port) with $(osquery.columns.protocol) protocol</description>
            <group>incident_response,</group>
          </rule>

          <rule id="24032" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">mounts</field>
            <description>osquery: $(osquery.name): Mount point at $(osquery.columns.device) with $(osquery.columns.blocks_free) free blocks</description>
            <group>incident_response,</group>
          </rule>

          <rule id="24033" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">process_memory</field>
            <description>osquery: $(osquery.name): Process with ID $(osquery.columns.pid) and path $(osquery.columns.path) has permissions $(osquery.columns.permissions)</description>
            <group>incident_response,</group>
          </rule>
          
          <rule id="24034" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">iptables</field>
            <description>osquery: $(osquery.name): Iptable source ip $(osquery.columns.src_ip) with policy $(osquery.columns.policy) and target $(osquery.columns.target) has a packet count of $(osquery.columns.packets)</description>
            <group>incident_response,</group>
          </rule>

          <rule id="24035" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">logged_in_users</field>
            <description>osquery: $(osquery.name): User $(osquery.columns.user) is logged from host $(osquery.columns.host) </description>
            <group>incident_response,</group>
          </rule>

          <rule id="24036" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">ramdisk</field>
            <description>osquery: $(osquery.name): Device with label $(osquery.columns.label) and name $(osquery.columns.name) has $(osquery.columns.size) blocks</description>
            <group>incident_response,</group>
          </rule>

          <rule id="24037" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">launchd</field>
            <description>osquery: $(osquery.name): Running daemon is $(osquery.columns.label) with path $(osquery.columns.program) and username $(osquery.columns.username)</description>
            <group>incident_response,</group>
          </rule>

          <rule id="24038" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">crontab</field>
            <description>osquery: $(osquery.name): Command launched $(osquery.columns.command) at $(osquery.columns.hour):$(osquery.columns.minute) $(osquery.columns.day_of_month) $(osquery.columns.month) </description>
            <group>incident_response,</group>
          </rule> 

          <rule id="24039" level="4">
            <if_sid>24030</if_sid>
            <field name="osquery.name">last</field>
            <description>osquery: $(osquery.name): User $(osquery.columns.username) logged-in/out from host $(osquery.columns.host)</description>
            <group>incident_response,</group>
          </rule> 

  <rule id="24040" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^it-compliance$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>it_compliance,</group>
  </rule>

          <rule id="24041" level="4">
            <if_sid>24040</if_sid>
            <field name="osquery.name">kernel_info</field>
            <description>osquery: $(osquery.name): OS kernel version $(osquery.columns.version), path $(osquery.columns.path)</description>
            <group>it_compliance,</group>
          </rule>

          <rule id="24042" level="4">
            <if_sid>24040</if_sid>
            <field name="osquery.name">kernel_modules</field>
            <description>osquery: $(osquery.name): OS kernel module $(osquery.columns.name) is used by $(osquery.columns.used_by) and it status is $(osquery.columns.status)</description>
            <group>it_compliance,</group>
          </rule>

          <rule id="24043" level="4">
            <if_sid>24040</if_sid>
            <field name="osquery.name">os_version</field>
            <description>osquery: $(osquery.name): OS $(osquery.columns.name) $(osquery.columns.version) with minor $(osquery.columns.minor) and major $(osquery.columns.major)</description>
            <group>it_compliance,</group>
          </rule>

          <rule id="24044" level="4">
            <if_sid>24040</if_sid>
            <field name="osquery.name">mounts</field>
            <description>osquery: $(osquery.name): Mount point at $(osquery.columns.device) with $(osquery.columns.blocks_free) free blocks</description>
            <group>it_compliance,</group>
          </rule>

          <rule id="24045" level="4">
            <if_sid>24040</if_sid>
            <field name="osquery.name">deb_packages</field>
            <description>osquery: $(osquery.name): Package name $(osquery.columns.name), version $(osquery.columns.version), revision $(osquery.columns.revision),size $(osquery.columns.size) bytes</description>
            <group>it_compliance,</group>
          </rule>

          <rule id="24046" level="4">
            <if_sid>24040</if_sid>
            <field name="osquery.name">apt_sources</field>
            <description>osquery: $(osquery.name): Repository name $(osquery.columns.name), version $(osquery.columns.version), source $(osquery.columns.source),release name $(osquery.columns.release)</description>
            <group>it_compliance,</group>
          </rule>

  <rule id="24050" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^osx-attacks$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>osx_attacks,</group>
  </rule>

  <rule id="24060" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^vuln-management$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>vuln_management,</group>
  </rule>

          <rule id="24061" level="4">
            <if_sid>24060</if_sid>
            <field name="osquery.name">os_version</field>
            <description>osquery: $(osquery.name): OS $(osquery.columns.name) $(osquery.columns.version) with minor $(osquery.columns.minor) and major $(osquery.columns.major)</description>
            <group>vuln_management,</group>
          </rule>

          <rule id="24062" level="4">
            <if_sid>24060</if_sid>
            <field name="osquery.name">kernel_modules</field>
            <description>osquery: $(osquery.name): OS kernel module $(osquery.columns.name) is used by $(osquery.columns.used_by) and it status is $(osquery.columns.status)</description>
            <group>vuln_management,</group>
          </rule>

          <rule id="24063" level="4">
            <if_sid>24060</if_sid>
            <field name="osquery.name">firefox_addons</field>
            <description>osquery: $(osquery.name): Firefox addon $(osquery.columns.name) type is $(osquery.columns.type) and the user that owns it is $(osquery.columns.uid)</description>
            <group>vuln_management,</group>
          </rule>

          <rule id="24064" level="4">
            <if_sid>24060</if_sid>
            <field name="osquery.name">chrome_extensions</field>
            <description>osquery: $(osquery.name): Chrome extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
            <group>vuln_management,</group>
          </rule>

          <rule id="24065" level="4">
            <if_sid>24060</if_sid>
            <field name="osquery.name">safari_extensions</field>
            <description>osquery: $(osquery.name): Safari extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
            <group>vuln_management,</group>
          </rule>

          <rule id="24066" level="4">
            <if_sid>24060</if_sid>
            <field name="osquery.name">opera_extensions</field>
            <description>osquery: $(osquery.name): Opera extension $(osquery.columns.name) version is $(osquery.columns.version) and the user that owns it is $(osquery.columns.uid)</description>
            <group>vuln_management,</group>
          </rule>

  <rule id="24070" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^hardware-monitoring$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>hardware_monitoring,</group>
  </rule>

          <rule id="24071" level="4">
            <if_sid>24070</if_sid>
            <field name="osquery.name">acpi_tables</field>
            <description>osquery: $(osquery.name): ACPI table $(osquery.columns.name) size is $(osquery.columns.size)</description>
            <group>hardware_monitoring,</group>
          </rule>

          <rule id="24072" level="4">
            <if_sid>24070</if_sid>
            <field name="osquery.name">cpuid</field>
            <description>osquery: $(osquery.name): CPU feature $(osquery.columns.feature) and value $(osquery.columns.value)</description>
            <group>hardware_monitoring,</group>
          </rule>

          <rule id="24073" level="4">
            <if_sid>24070</if_sid>
            <field name="osquery.name">smbios_tables</field>
            <description>osquery: $(osquery.name): ACPI table $(osquery.columns.name) size is $(osquery.columns.size)</description>
            <group>hardware_monitoring,</group>
          </rule>

          <rule id="24074" level="4">
            <if_sid>24070</if_sid>
            <field name="osquery.name">fan_speeds</field>
            <description>osquery: $(osquery.name): Fan $(osquery.columns.name) actual speed is $(osquery.columns.actual) rpm</description>
            <group>hardware_monitoring,</group>
          </rule>

          <rule id="24075" level="4">
            <if_sid>24070</if_sid>
            <field name="osquery.name">temperatures</field>
            <description>osquery: $(osquery.name): Temperature sensor $(osquery.columns.name) is at $(osquery.columns.celsius) celsius</description>
            <group>hardware_monitoring,</group>
          </rule>

          <rule id="24076" level="4">
            <if_sid>24070</if_sid>
            <field name="osquery.name">usb_devices</field>
            <description>osquery: $(osquery.name): USB device with vendor $(osquery.columns.vendor_id) is attached to port $(osquery.columns.usb_port)</description>
            <group>hardware_monitoring,</group>
          </rule>

          <rule id="24077" level="4">
            <if_sid>24070</if_sid>
            <field name="osquery.name">kernel_modules</field>
            <description>osquery: $(osquery.name): OS kernel module $(osquery.columns.name) is used by $(osquery.columns.used_by) and it status is $(osquery.columns.status)</description>
            <group>hardware_monitoring,</group>
          </rule>


  <rule id="24080" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^ossec-rootkit$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>ossec_rootkit,</group>
  </rule>

  <rule id="24090" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^windows-hardening$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>windows_hardening,</group>
  </rule>

  <rule id="24100" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^windows-attacks$</field>
    <description>osquery: $(osquery.name) query result</description>
    <group>windows_attacks,</group>
  </rule>

  <rule id="24110" level="4">
    <if_sid>24010</if_sid>
    <field name="osquery.pack">^unwanted-chrome-extensions$</field>
    <description>osquery: $(osquery.name) query result</description>
  </rule>

</group>
