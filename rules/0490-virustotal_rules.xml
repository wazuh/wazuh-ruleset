<!--
  -  VirusTotal integration rules
  -  Created by Wazuh, Inc. <support@wazuh.com>.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<!-- ID: 87100 - 87199 -->

<group name="virustotal,">

    <rule id="87100" level="0">
        <decoded_as>json</decoded_as>
        <field name="integration">virustotal</field>
        <description>VirusTotal integration messages.</description>
    </rule>

    <rule id="87101" level="3">
        <if_sid>87100</if_sid>
        <field name="virustotal.error">204</field>
        <description>VirusTotal: Error: Public API request rate limit reached</description>
    </rule>

    <rule id="87102" level="3">
        <if_sid>87100</if_sid>
        <field name="virustotal.error">403</field>
        <description>VirusTotal: Error: Check credentials</description>
        <group>pci_dss_10.2.5,gdpr_2.6,gdpr_2.7,gdpr_5,</group>
    </rule>

    <rule id="87103" level="3">
        <if_sid>87100</if_sid>
        <field name="virustotal.found">0</field>
        <description>VirusTotal: Alert - No records in VirusTotal database</description>
    </rule>

    <rule id="87104" level="3">
        <if_sid>87100</if_sid>
        <field name="virustotal.found">1</field>
        <field name="virustotal.malicious">0</field>
        <description>VirusTotal: Alert - $(virustotal.source.file) - No positives found</description>
    </rule>

    <rule id="87105" level="12">
        <if_sid>87100</if_sid>
        <field name="virustotal.malicious">1</field>
        <description>VirusTotal: Alert - $(virustotal.source.file) - $(virustotal.positives) engines detected this file</description>
        <group>pci_dss_10.6.1,pci_dss_11.4,gdpr_2.3,gdpr_2.4,</group>
    </rule>
 
</group>
