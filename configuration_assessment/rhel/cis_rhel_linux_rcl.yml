# Copyright (C) 2015-2019, Wazuh Inc.
#
# This program is a free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# OSSEC Linux Audit - (C) 2014
#
# Released under the same license as OSSEC.
# More details at the LICENSE file included with OSSEC or online
# at: https://www.gnu.org/licenses/gpl.html
#
# [Application name] [any or all] [reference]
# type:<entry name>;
#
# Type can be:
#             - f (for file or directory)
#             - p (process running)
#             - d (any file inside the directory)
#
# Additional values:
# For the registry and for directories, use "->" to look for a specific entry and another
# "->" to look for the value.
# Also, use " -> r:^\. -> ..." to search all files in a directory
# For files, use "->" to look for a specific value in the file.
#
# Values can be preceded by: =: (for equal) - default
#                             r: (for ossec regexes)
#                             >: (for strcmp greater)
#                             <: (for strcmp  lower)
# Multiple patterns can be specified by using " && " between them.
# (All of them must match for it to return true).
# CIS Checks for Red Hat (RHEL 2.1, 3.0, 4.0 and Fedora Core 1,2,3,4 and 5).
# Based on CIS Benchmark for Red Hat Enterprise Linux v1.0.5
# RC scripts location
policy:
  id: ""
  file: ""
  name: ""
  description: ""
  references:
    - 

requirements:
  title: ""
  description: ""
  condition: ""
  description: ""
  rules:
    - 

variables:
 $rc_dirs: /etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;
# Main one. Only valid for Red Hat/Fedora.

checks:
 - id: 4999
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any required
   rules:
     - 'f:/etc/redhat-release -> r:^Red Hat Enterprise Linux \S+ release 4;'
     - 'f:/etc/redhat-release -> r:^Red Hat Enterprise Linux \S+ release 3;'
     - 'f:/etc/redhat-release -> r:^Red Hat Enterprise Linux \S+ release 2.1;'
     - 'f:/etc/fedora-release -> r:^Fedora && r:release 1;'
     - 'f:/etc/fedora-release -> r:^Fedora && r:release 2;'
     - 'f:/etc/fedora-release -> r:^Fedora && r:release 3;'
     - 'f:/etc/fedora-release -> r:^Fedora && r:release 4;'
     - 'f:/etc/fedora-release -> r:^Fedora && r:release 5;'
# Build considerations - Partition scheme.
 - id: 5000
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:/var;'
 - id: 5001
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:/home;'
# Section 1.3 - SSH configuration
 cis: "Red Hat Linux - 1.3 - SSH Configuration - Protocol version 1 enabled {CIS"
 - id: 5002
   title: "1.3 Red Hat Linux} {PCI_DSS"
   description: "1.3 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 1.3 - SSH Configuration - Protocol version 1 enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/ssh/sshd_config -> !r:^# && r:Protocol\.+1;'
 cis: "Red Hat Linux - 1.3 - SSH Configuration - IgnoreRHosts disabled {CIS"
 - id: 5003
   title: "1.3 Red Hat Linux} {PCI_DSS"
   description: "1.3 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 1.3 - SSH Configuration - IgnoreRHosts disabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\.+no;'
 cis: "Red Hat Linux - 1.3 - SSH Configuration - Empty passwords permitted {CIS"
 - id: 5004
   title: "1.3 Red Hat Linux} {PCI_DSS"
   description: "1.3 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 1.3 - SSH Configuration - Empty passwords permitted {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\.+yes;'
 cis: "Red Hat Linux - 1.3 - SSH Configuration - Host based authentication enabled {CIS"
 - id: 5005
   title: "1.3 Red Hat Linux} {PCI_DSS"
   description: "1.3 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 1.3 - SSH Configuration - Host based authentication enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\.+yes;'
 cis: "Red Hat Linux - 1.3 - SSH Configuration - Root login allowed {CIS"
 - id: 5006
   title: "1.3 Red Hat Linux} {PCI_DSS"
   description: "1.3 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 1.3 - SSH Configuration - Root login allowed {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\.+yes;'
# Section 1.4 Enable system accounting
#[CIS - Red Hat Linux - 1.4 - System Accounting - Sysstat not installed] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]
#f:!/var/log/sa;
# Section 2.5 Install and run Bastille
#[CIS - Red Hat Linux - 1.5 - System harderning - Bastille is not installed] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]
#f:!/etc/Bastille;
# Section 2 - Minimize xinetd services
 cis: "Red Hat Linux - 2.3 - Telnet enabled on xinetd {CIS"
 - id: 5007
   title: "2.3 Red Hat Linux} {PCI_DSS"
   description: "2.3 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 2.3 - Telnet enabled on xinetd {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/xinetd.c/telnet -> !r:^# && r:disable && r:no;'
 cis: "Red Hat Linux - 2.4 - VSFTP enabled on xinetd {CIS"
 - id: 5008
   title: "2.4 Red Hat Linux} {PCI_DSS"
   description: "2.4 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 2.4 - VSFTP enabled on xinetd {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/xinetd.c/vsftpd -> !r:^# && r:disable && r:no;'
 cis: "Red Hat Linux - 2.4 - WU-FTP enabled on xinetd {CIS"
 - id: 5009
   title: "2.4 Red Hat Linux} {PCI_DSS"
   description: "2.4 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 2.4 - WU-FTP enabled on xinetd {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/xinetd.c/wu-ftpd -> !r:^# && r:disable && r:no;'
 cis: "Red Hat Linux - 2.5 - rsh/rlogin/rcp enabled on xinetd {CIS"
 - id: 5010
   title: "2.5 Red Hat Linux} {PCI_DSS"
   description: "2.5 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 2.5 - rsh/rlogin/rcp enabled on xinetd {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/xinetd.c/rlogin -> !r:^# && r:disable && r:no;'
     - 'f:/etc/xinetd.c/rsh -> !r:^# && r:disable && r:no;'
     - 'f:/etc/xinetd.c/shell -> !r:^# && r:disable && r:no;'
 cis: "Red Hat Linux - 2.6 - tftpd enabled on xinetd {CIS"
 - id: 5011
   title: "2.6 Red Hat Linux} {PCI_DSS"
   description: "2.6 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 2.6 - tftpd enabled on xinetd {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/xinetd.c/tftpd -> !r:^# && r:disable && r:no;'
 cis: "Red Hat Linux - 2.7 - imap enabled on xinetd {CIS"
 - id: 5012
   title: "2.7 Red Hat Linux} {PCI_DSS"
   description: "2.7 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 2.7 - imap enabled on xinetd {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/xinetd.c/imap -> !r:^# && r:disable && r:no;'
     - 'f:/etc/xinetd.c/imaps -> !r:^# && r:disable && r:no;'
 cis: "Red Hat Linux - 2.8 - pop3 enabled on xinetd {CIS"
 - id: 5013
   title: "2.8 Red Hat Linux} {PCI_DSS"
   description: "2.8 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 2.8 - pop3 enabled on xinetd {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/xinetd.c/ipop3 -> !r:^# && r:disable && r:no;'
     - 'f:/etc/xinetd.c/pop3s -> !r:^# && r:disable && r:no;'
# Section 3 - Minimize boot services
 cis: "Red Hat Linux - 3.1 - Set daemon umask - Default umask is higher than 027 {CIS"
 - id: 5014
   title: "3.1 Red Hat Linux}"
   description: "3.1 Red Hat Linux}"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.1 - Set daemon umask - Default umask is higher than 027 {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: all
   rules:
     - 'f:/etc/init.d/functions -> !r:^# && r:^umask && >:umask 027;'
 cis: "Red Hat Linux - 3.4 - GUI login enabled {CIS"
 - id: 5015
   title: "3.4 Red Hat Linux} {PCI_DSS"
   description: "3.4 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.4 - GUI login enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/inittab -> !r:^# && r:id:5;'
 cis: "Red Hat Linux - 3.7 - Disable standard boot services - Samba Enabled {CIS"
 - id: 5016
   title: "3.7 Red Hat Linux} {PCI_DSS"
   description: "3.7 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.7 - Disable standard boot services - Samba Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dsamba$;'
     - 'd:$rc_dirs -> ^S\d\dsmb$;'
 cis: "Red Hat Linux - 3.8 - Disable standard boot services - NFS Enabled {CIS"
 - id: 5017
   title: "3.8 Red Hat Linux} {PCI_DSS"
   description: "3.8 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.8 - Disable standard boot services - NFS Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dnfs$;'
     - 'd:$rc_dirs -> ^S\d\dnfslock$;'
 cis: "Red Hat Linux - 3.10 - Disable standard boot services - NIS Enabled {CIS"
 - id: 5018
   title: "3.10 Red Hat Linux} {PCI_DSS"
   description: "3.10 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.10 - Disable standard boot services - NIS Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dypbind$;'
     - 'd:$rc_dirs -> ^S\d\dypserv$;'
 cis: "Red Hat Linux - 3.13 - Disable standard boot services - NetFS Enabled {CIS"
 - id: 5019
   title: "3.13 Red Hat Linux} {PCI_DSS"
   description: "3.13 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.13 - Disable standard boot services - NetFS Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dnetfs$;'
 cis: "Red Hat Linux - 3.15 - Disable standard boot services - Apache web server Enabled {CIS"
 - id: 5020
   title: "3.15 Red Hat Linux} {PCI_DSS"
   description: "3.15 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.15 - Disable standard boot services - Apache web server Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dapache$;'
     - 'd:$rc_dirs -> ^S\d\dhttpd$;'
 cis: "Red Hat Linux - 3.15 - Disable standard boot services - TUX web server Enabled {CIS"
 - id: 5021
   title: "3.15 Red Hat Linux} {PCI_DSS"
   description: "3.15 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.15 - Disable standard boot services - TUX web server Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dtux$;'
 cis: "Red Hat Linux - 3.16 - Disable standard boot services - SNMPD process Enabled {CIS"
 - id: 5022
   title: "3.16 Red Hat Linux} {PCI_DSS"
   description: "3.16 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.16 - Disable standard boot services - SNMPD process Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dsnmpd$;'
 cis: "Red Hat Linux - 3.17 - Disable standard boot services - DNS server Enabled {CIS"
 - id: 5023
   title: "3.17 Red Hat Linux} {PCI_DSS"
   description: "3.17 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.17 - Disable standard boot services - DNS server Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dnamed$;'
 cis: "Red Hat Linux - 3.18 - Disable standard boot services - MySQL server Enabled {CIS"
 - id: 5024
   title: "3.18 Red Hat Linux} {PCI_DSS"
   description: "3.18 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.18 - Disable standard boot services - MySQL server Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dmysqld$;'
 cis: "Red Hat Linux - 3.18 - Disable standard boot services - PostgreSQL server Enabled {CIS"
 - id: 5025
   title: "3.18 Red Hat Linux} {PCI_DSS"
   description: "3.18 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.18 - Disable standard boot services - PostgreSQL server Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dpostgresql$;'
 cis: "Red Hat Linux - 3.19 - Disable standard boot services - Webmin Enabled {CIS"
 - id: 5026
   title: "3.19 Red Hat Linux} {PCI_DSS"
   description: "3.19 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.19 - Disable standard boot services - Webmin Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dwebmin$;'
 cis: "Red Hat Linux - 3.20 - Disable standard boot services - Squid Enabled {CIS"
 - id: 5027
   title: "3.20 Red Hat Linux} {PCI_DSS"
   description: "3.20 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.20 - Disable standard boot services - Squid Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dsquid$;'
 cis: "Red Hat Linux - 3.21 - Disable standard boot services - Kudzu hardware detection Enabled {CIS"
 - id: 5028
   title: "3.21 Red Hat Linux} {PCI_DSS"
   description: "3.21 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 3.21 - Disable standard boot services - Kudzu hardware detection Enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'd:$rc_dirs -> ^S\d\dkudzu$;'
# Section 4 - Kernel tuning
 cis: "Red Hat Linux - 4.1 - Network parameters - Source routing accepted {CIS"
 - id: 5029
   title: "4.1 Red Hat Linux}"
   description: "4.1 Red Hat Linux}"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 4.1 - Network parameters - Source routing accepted {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;'
 cis: "Red Hat Linux - 4.1 - Network parameters - ICMP broadcasts accepted {CIS"
 - id: 5030
   title: "4.1 Red Hat Linux}"
   description: "4.1 Red Hat Linux}"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 4.1 - Network parameters - ICMP broadcasts accepted {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;'
 cis: "Red Hat Linux - 4.2 - Network parameters - IP Forwarding enabled {CIS"
 - id: 5031
   title: "4.2 Red Hat Linux}"
   description: "4.2 Red Hat Linux}"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 4.2 - Network parameters - IP Forwarding enabled {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/proc/sys/net/ipv4/ip_forward -> 1;'
     - 'f:/proc/sys/net/ipv6/ip_forward -> 1;'
# Section 6 - Permissions
 cis: "Red Hat Linux - 6.1 - Partition /var without 'nodev' set {CIS"
 - id: 5032
   title: "6.1 Red Hat Linux} {PCI_DSS"
   description: "6.1 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 6.1 - Partition /var without 'nodev' set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/var && !r:nodev;'
 cis: "Red Hat Linux - 6.1 - Partition /tmp without 'nodev' set {CIS"
 - id: 5033
   title: "6.1 Red Hat Linux} {PCI_DSS"
   description: "6.1 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 6.1 - Partition /tmp without 'nodev' set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/tmp && !r:nodev;'
 cis: "Red Hat Linux - 6.1 - Partition /opt without 'nodev' set {CIS"
 - id: 5034
   title: "6.1 Red Hat Linux} {PCI_DSS"
   description: "6.1 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 6.1 - Partition /opt without 'nodev' set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/opt && !r:nodev;'
 cis: "Red Hat Linux - 6.1 - Partition /home without 'nodev' set {CIS"
 - id: 5035
   title: "6.1 Red Hat Linux} {PCI_DSS"
   description: "6.1 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 6.1 - Partition /home without 'nodev' set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/home && !r:nodev ;'
 cis: "Red Hat Linux - 6.2 - Removable partition /media without 'nodev' set {CIS"
 - id: 5036
   title: "6.2 Red Hat Linux} {PCI_DSS"
   description: "6.2 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 6.2 - Removable partition /media without 'nodev' set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:^# && r:/media && !r:nodev;'
 cis: "Red Hat Linux - 6.2 - Removable partition /media without 'nosuid' set {CIS"
 - id: 5037
   title: "6.2 Red Hat Linux} {PCI_DSS"
   description: "6.2 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 6.2 - Removable partition /media without 'nosuid' set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/fstab -> !r:^# && r:/media && !r:nosuid;'
 cis: "Red Hat Linux - 6.3 - User-mounted removable partition allowed on the console {CIS"
 - id: 5038
   title: "6.3 Red Hat Linux} {PCI_DSS"
   description: "6.3 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 6.3 - User-mounted removable partition allowed on the console {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/security/console.perms -> r:^<console>  \d+ <cdrom>;'
     - 'f:/etc/security/console.perms -> r:^<console>  \d+ <floppy>;'
# Section 7 - Access and authentication
 cis: "Red Hat Linux - 7.8 - LILO Password not set {CIS"
 - id: 5039
   title: "7.8 Red Hat Linux} {PCI_DSS"
   description: "7.8 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 7.8 - LILO Password not set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/lilo.conf -> !r:^# && !r:restricted;'
     - 'f:/etc/lilo.conf -> !r:^# && !r:password=;'
 cis: "Red Hat Linux - 7.8 - GRUB Password not set {CIS"
 - id: 5040
   title: "7.8 Red Hat Linux} {PCI_DSS"
   description: "7.8 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 7.8 - GRUB Password not set {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/boot/grub/menu.lst -> !r:^# && !r:password;'
 cis: "Red Hat Linux - 8.2 - Account with empty password present {CIS"
 - id: 5041
   title: "8.2 Red Hat Linux} {PCI_DSS"
   description: "8.2 Red Hat Linux} {PCI_DSS"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - 8.2 - Account with empty password present {CIS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/shadow -> r:^\w+::;'
 cis: "Red Hat Linux - SN.11 - Non-root account with uid 0 {PCI_DSS"
 - id: 5042
   title: "10.2.5}"
   description: "10.2.5}"
   rationale: ""
   remediation: ""
   compliance:
    - cis: "Red Hat Linux - SN.11 - Non-root account with uid 0 {PCI_DSS"
    - cis_csc: ""
   references:
    - https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf
   condition: any
   rules:
     - 'f:/etc/passwd -> !r:^# && !r:^root: && r:^\w+:\w+:0:;'
# Tests specific for VMware ESX - Runs on Red Hat Linux -
# Will not be tested anywhere else.
 - id: 5043
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any required
   rules:
     - 'f:/etc/vmware-release -> r:^VMware ESX;'
# Virtual Machine Files and Settings - 1
# 1.1
 - id: 5044
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.copy.disable;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.copy.disable && r:false;'
# 1.2
 - id: 5045
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.paste.disable;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.paste.disable && r:false;'
# 1.3
 - id: 5046
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.setGUIOptions.enable && r:true;'
# 1.4
 - id: 5047
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^log.rotateSize;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^log.rotateSize && !r:"100000";'
# 1.5
 - id: 5048
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^log.keepOld;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^log.keepOld && r:"10";'
# 1.6
 - id: 5049
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.setinfo.disable;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.setinfo.disable && r:false;'
# 1.7
 - id: 5050
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> r:^scsi\d:\d.mode && r:!independent-nonpersistent;'
# 1.8
 - id: 5051
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> r:^floppy\d+.present && r:!false;'
 - id: 5052
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> r:^serial\d+.present && r:!false;'
 - id: 5053
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> r:^parallel\d+.present && r:!false;'
# 1.9
 - id: 5054
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^Isolation.tools.connectable.disable;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^Isolation.tools.connectable.disable && r:false;'
# 1.10
 - id: 5055
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.diskWiper.disable;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.diskWiper.disable && r:false;'
 - id: 5056
   title: ""
   description: ""
   rationale: ""
   remediation: ""
   compliance:
    - cis: ""
    - cis_csc: ""
   references:
    - http://www.vmware.com/pdf/vi3_security_hardening_wp.pdf
   condition: any
   rules:
     - 'd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.diskShrink.disable;'
     - 'd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.diskShrink.disable && r:false;'
# Configuring the Service Console in ESX 3.5 - 2
# 2.1
